section	.text


   global _start    ;must be declared for using gcc
	
_start:             ;tell linker entry point
    mov bh,0
    mov ah,0
    mov esi,fr
    
_loop1:
    mov edi, DataIn
    xorps Xmm0,Xmm0
    mov al,0
    cmp ah,63
    jne _loop2
    mov ah,0
    jmp _loopprint
    
_loop2:
    movss Xmm2,[esi]
    movss Xmm3,[edi]
    mulss Xmm2,Xmm3
    addss Xmm0,Xmm2
    add edi,2
    add al,1
    add esi,2
    add ah,1
    cmp al,7
    jne _loop2
    jmp _save


_loopprint:
    add edx,DataOut
    add edx,ah
    mov ecx,[edx]
    mov eax,4
    mov edx,32
    mov ebx,1
    mov ah,4
    int 80h
    cmp ah,32      ;no puede ser volatil
    jne _loopprint
    mov eax,1
    mov ebx,1
    int 80h
    
_save:
    mov eax,DataOut
    add eax,bh
    movss [eax],Xmm0
    add bh,4
    jmp _loop1
    
	
section .data
global fr
global DataOut
global DataIn

fr:
    dw 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000
    dw 1.000000, 0.707106, 0.000000, -0.707106, -1.000000, -0.707106, 0.000000, 0.707106
    dw 1.000000, 0.000000, -1.000000, 0.000000, 1.000000, 0.000000, -1.000000, 0.000000
    dw 1.000000,-0.707106, 0.000000, 0.707106, -1.000000, 0.707106, 0.000000, -0.707106
    dw 1.000000, -1.00000, 1.000000, -1.000000, 1.00000, -1.000000,  1.000000,  -1.000000
    dw 1.000000, -0.707106, 0.000000, 0.707106, -1.000000, 0.707106, 0.000000, -0.707106
    dw 1.000000, 0.000000, -1.000000, 0.000000, 1.000000, 0.000000, -1.000000, 0.000000
    dw 1.000000, 0.707106, 0.000000, -0.707106, -1.000000, -0.707106, 0.000000, 0.707106

fi:
    dw 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000
    dw 1.000000, 0.707106, 0.000000, -0.707106, -1.000000, -0.707106, 0.000000, 0.707106
    dw 1.000000, 0.000000, -1.000000, 0.000000, 1.000000, 0.000000, -1.000000, 0.000000
    dw 1.000000,-0.707106, 0.000000, 0.707106, -1.000000, 0.707106, 0.000000, -0.707106
    dw 1.000000, -1.00000, 1.000000, -1.000000, 1.00000, -1.000000,  1.000000,  -1.000000
    dw 1.000000, -0.707106, 0.000000, 0.707106, -1.000000, 0.707106, 0.000000, -0.707106
    dw 1.000000, 0.000000, -1.000000, 0.000000, 1.000000, 0.000000, -1.000000, 0.000000
    dw 1.000000, 0.707106, 0.000000, -0.707106, -1.000000, -0.707106, 0.000000, 0.707106

DataOut dd 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
DataIn dw 1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0
